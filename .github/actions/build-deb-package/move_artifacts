#!/bin/sh

set -eu

# Usage:
#   mv_other BUILDINFO EXT DEST
mv_other()
{
	a=${1%.buildinfo}$2
	[ ! -f "$a" ] || mv -- "$a" "$3"
}

echo "::group::Moving artifacts"

mkdir -p -- "$BDP_ARTIFACTS_DIR"

while read -r l; do
	artifact=$BDP_SOURCES_DIR/../${l%% *}
	mv -- "$artifact" "$BDP_ARTIFACTS_DIR"
	case "$artifact" in
		*.buildinfo)
			# Ignoring the stuff generated by dpkg-source here for now.
			mv_other "$artifact" .changes "$BDP_ARTIFACTS_DIR"
			;;
	esac
done < "$BDP_SOURCES_DIR/debian/files"

echo "::endgroup"
